<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bouclier d'Empathie Sombre</title>
    <script src="https://cdn.tailwindcss.com?plugins=typography"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <link
        href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&family=Inter:wght@300;400;600&display=swap"
        rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #050505;
            color: #e5e5e5;
        }

        .mono {
            font-family: 'JetBrains Mono', monospace;
        }

        /* Chat Bubbles */
        .msg-bot {
            background: rgba(255, 255, 255, 0.05);
            border-left: 2px solid #ef4444;
            border-radius: 0 12px 12px 12px;
        }

        .msg-user {
            background: rgba(239, 68, 68, 0.1);
            border-right: 2px solid #ef4444;
            border-radius: 12px 0 12px 12px;
            margin-left: auto;
        }

        .typing-dot {
            animation: typing 1.4s infinite ease-in-out both;
        }

        .typing-dot:nth-child(1) {
            animation-delay: -0.32s;
        }

        .typing-dot:nth-child(2) {
            animation-delay: -0.16s;
        }

        @keyframes typing {

            0%,
            80%,
            100% {
                transform: scale(0);
            }

            40% {
                transform: scale(1);
            }
        }

        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 6px;
        }

        ::-webkit-scrollbar-track {
            background: transparent;
        }

        ::-webkit-scrollbar-thumb {
            background: #333;
            border-radius: 3px;
        }
    </style>
</head>

<body class="h-screen flex flex-col items-center justify-center p-0 md:p-4 overflow-hidden">

    <!-- Header -->
    <header class="w-full max-w-2xl p-4 flex justify-between items-center border-b border-gray-800 bg-[#050505] z-10">
        <div class="container mx-auto px-4 py-4 flex justify-between items-center">
            <div class="flex items-center gap-3">
                <div class="w-3 h-3 rounded-full bg-red-500 animate-pulse shadow-[0_0_10px_#ef4444]"></div>
                <h1 class="text-2xl font-bold tracking-wider text-gray-100">DARK EMPATHY <span
                        class="text-red-600">SHIELD</span></h1>
            </div>
            <button id="settingsBtn" class="p-2 text-gray-400 hover:text-white transition-colors">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24"
                    stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                        d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z" />
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                        d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                </svg>
            </button>
        </div>
    </header>

    <!-- API Key Modal -->
    <div id="settingsModal"
        class="fixed inset-0 bg-black/90 hidden flex items-center justify-center z-50 backdrop-blur-sm">
        <div
            class="bg-gray-900 border border-gray-800 p-8 rounded-2xl w-full max-w-md shadow-[0_0_50px_rgba(0,0,0,0.8)]">
            <h2 class="text-2xl font-bold mb-6 text-white flex items-center gap-2">
                <span class="text-red-500">‚ö°</span> CONNEXION IA
            </h2>
            <p class="text-gray-400 mb-6 text-sm">Pour une intelligence r√©elle, connectez une cl√© API Gemini. Sinon, le
                syst√®me utilisera sa base de donn√©es locale (limit√©e).</p>

            <div class="space-y-4">
                <div>
                    <label class="block text-xs font-medium text-gray-500 mb-1 uppercase tracking-wider">Cl√© API Google
                        Gemini</label>
                    <input type="password" id="apiKeyInput"
                        class="w-full bg-black border border-gray-800 rounded-lg px-4 py-3 text-white focus:outline-none focus:border-red-500 focus:ring-1 focus:ring-red-500 transition-all placeholder-gray-700"
                        placeholder="AIzaSy...">
                </div>
            </div>

            <div class="mt-8 flex justify-end gap-3">
                <button id="closeSettings"
                    class="px-4 py-2 text-gray-400 hover:text-white transition-colors text-sm">Annuler</button>
                <button id="saveSettings"
                    class="px-6 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg font-medium transition-all shadow-[0_0_20px_rgba(220,38,38,0.3)] hover:shadow-[0_0_30px_rgba(220,38,38,0.5)]">CONNECTER</button>
            </div>
        </div>
    </div>

    <!-- Chat Area -->
    <main id="chat-container" class="flex-1 w-full max-w-2xl overflow-y-auto p-4 space-y-6 pb-24">
        <!-- Messages will appear here -->
        <div id="welcome-msg" class="msg-bot p-4 max-w-[85%] fade-in">
            <p class="text-gray-300 leading-relaxed">
                <strong>üõ°Ô∏è DARK EMPATHY SHIELD // ACTIV√â</strong><br><br>
                <span style="color:#9ca3af;">Mode actuel :</span> <strong style="color:#eab308;">BASE
                    LOCALE</strong><br>
                <span style="color:#6b7280; font-size:0.9em;">Intelligence limit√©e, mais op√©rationnel.</span><br><br>
                üí° <strong>Pour activer l'IA cloud (analyse avanc√©e) :</strong><br>
                <span style="color:#6b7280; font-size:0.9em;">Clique sur ‚öôÔ∏è en haut √† droite ‚Üí Colle ta cl√© API
                    Gemini</span><br><br>
                <strong>Raconte-moi ce qu'il fait.</strong> Je te dirai pourquoi il le fait.
            </p>
        </div>
    </main>

    <!-- Input Area -->
    <footer class="w-full max-w-2xl p-4 bg-[#050505] border-t border-gray-800 fixed bottom-0 md:relative">
        <div class="flex gap-2">
            <button id="micBtn"
                class="p-4 rounded-xl bg-gray-800 text-gray-400 hover:text-white hover:bg-gray-700 transition-all border border-gray-700">
                üé§
            </button>
            <input type="text" id="user-input"
                class="flex-1 bg-gray-900 text-white rounded-xl px-6 py-4 focus:outline-none focus:ring-2 focus:ring-red-900 border border-gray-800 placeholder-gray-600"
                placeholder="Ex: Il m'offre des cadeaux puis m'insulte...">
            <button id="send-btn"
                class="bg-red-900 hover:bg-red-800 text-white px-8 py-4 rounded-xl font-bold transition-all transform hover:scale-105 shadow-[0_0_20px_rgba(153,27,27,0.3)]">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24"
                    stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                        d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8" />
                </svg>
            </button>
        </div>
    </footer>

    <!-- OLD SYSTEM - DISABLED -->
    <!-- <script src="dark_bible.js"></script> -->

    <!-- ACADEMIC KNOWLEDGE BASE -->
    <script src="thesis.js"></script>
    <script src="victim_approach_thesis.js"></script>

    <!-- MAIN APP -->
    <script src="app.js"></script>
</body>

</html>